<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>静の前端笔记</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="静の前端笔记">
<meta property="og:url" content="http://tanyafuzhou.com/index.html">
<meta property="og:site_name" content="静の前端笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="静の前端笔记">
  
  
    <link rel="icon" href="/mylogo.png">
  
  <link type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/scrollUp/image.css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div class="logo">
        <img src="/logo.png" alt="Profile Picture">
      </div>
      <div id="title">静の前端笔记</div>
      
       <ul class="my-socials">
  
 
</ul>
    </div>
  </div>
  <div id="header-inner" class="">
    <nav id="main-nav">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <!--
        
          
            <a class="main-nav-link" href="/">首页</a>
          
            <a class="main-nav-link" href="/categories/react">react</a>
          
            <a class="main-nav-link" href="/archives">归档</a>
          
        
      -->
    </nav>
    <nav id="title-nav" style="display:none">
      <a href="/">静の前端笔记</a>
      <img src="/logo.png" alt="Profile Picture">
      <!--
      <span id="title-nav-socials">
        
       
     </span>
      -->
    </nav>
    <nav id="sub-nav">
      
      <a id="nav-search-btn" class="nav-icon" title="Search"></a>
    </nav>
    <div id="search-form-wrap">
      <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
        <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
        <input type="submit" value="" class="search-form-submit">
        <input name=tn type=hidden value="bds">
        <input name=cl type=hidden value="3">
        <input name=ct type=hidden value="2097152">
        <input type="hidden" name="si" value="tanyafuzhou.com">
      </form>
    </div>
  </div>
  <div class="site-nav" style="display: none;">
    <ul>
      
      
        <li><a href="/">首页</a></li>
      
        <li><a href="/categories/react">react</a></li>
      
        <li><a href="/archives">归档</a></li>
      
      
    </ul>
  </div>
</header>
      <div class="outer">
        <section id="main">
  

    
    <article id="post-浅谈大型 react 项目前端构建" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/12/浅谈大型 react 项目前端构建/" class="article-date">
  <time datetime="2017-03-12T12:58:28.000Z" itemprop="datePublished">2017-03-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/react/">react</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/12/浅谈大型 react 项目前端构建/">浅谈大型 react 项目前端构建（持续更新中）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="一、项目目录"><a href="#一、项目目录" class="headerlink" title="一、项目目录"></a>一、项目目录</h1><img src="/2017/03/12/浅谈大型%20react%20项目前端构建/project.png" alt="project.png" title="">
<h2 id="开发阶段"><a href="#开发阶段" class="headerlink" title="开发阶段"></a>开发阶段</h2><ul>
<li>利用 webpack 或者 webapck+express 或者 webpack+koa 起服务</li>
<li>业务代码均在 src 目录下修改，其他文件不动</li>
</ul>
<h2 id="发布阶段"><a href="#发布阶段" class="headerlink" title="发布阶段"></a>发布阶段</h2><ul>
<li>利用 webpack.prod.config.js 生成 build 目录</li>
</ul>
<h1 id="二、src-业务代码的设计"><a href="#二、src-业务代码的设计" class="headerlink" title="二、src 业务代码的设计"></a>二、src 业务代码的设计</h1><img src="/2017/03/12/浅谈大型%20react%20项目前端构建/src.png" alt="src.png" title="">
<h2 id="1-路由"><a href="#1-路由" class="headerlink" title="1.路由"></a>1.路由</h2><p>  这个不用多说，果断用 react-router 进行路由的控制。</p>
<ul>
<li>App.js 中列出项目中所有的路由。</li>
<li>index.js作为入口文件，只引用 App.js，以及其他 hack。</li>
</ul>
<h2 id="2-公共组件（components）"><a href="#2-公共组件（components）" class="headerlink" title="2.公共组件（components）"></a>2.公共组件（components）</h2><p>  公共的业务组件统一放入 components 目录</p>
<p>  <em>注意</em></p>
<p>  公共的含义是：多于一个页面用到的组件称为公共组件，如果只有一个页面用到的组件，不要放到 components 目录，放到对应页面的子目录。</p>
<h2 id="3-高阶函数（hoc"><a href="#3-高阶函数（hoc" class="headerlink" title="3.高阶函数（hoc)"></a>3.高阶函数（hoc)</h2><p>  react 中有一个比较特色的功能，就是组件可以传入一个函数中生成新的高阶组件</p>
<p>  常见的应用场景，通常是一些页面经常性的重复操作，可封装成一个高阶函数，进行统一处理，避免重复写代码</p>
<ol>
<li>一些页面一进入就会去加载数据，此时便可使用高阶函数</li>
<li>如一些页面埋点的重复性操作</li>
</ol>
<h2 id="4-样式"><a href="#4-样式" class="headerlink" title="4.样式"></a>4.样式</h2><p>  项目中所有的样式都在 styles 目录下，该目录下的样式尽可能是公共组件的样式</p>
<p>  如果某些页面需要使用样式，直接使用 react 内置的 style功能，这样可以尽可能保持目录的纯净度。</p>
<h2 id="5-redux"><a href="#5-redux" class="headerlink" title="5.redux"></a>5.redux</h2><p>  如果需要使用 redux，可分为 store reducers action 三个目录进行控制</p>
<p>  切记 ，要分清 redux 的应用场景，不要滥用</p>
<h2 id="6-辅助工具（utils）"><a href="#6-辅助工具（utils）" class="headerlink" title="6.辅助工具（utils）"></a>6.辅助工具（utils）</h2><p>  主要存放项目全局需要经常使用到的工具类</p>
<h2 id="7-静态文件（data）"><a href="#7-静态文件（data）" class="headerlink" title="7.静态文件（data）"></a>7.静态文件（data）</h2><p>  主要存放静态常量等</p>
<h1 id="三、pages-目录"><a href="#三、pages-目录" class="headerlink" title="三、pages 目录"></a>三、pages 目录</h1><p>该目录与业务场景强相关，故在此先模拟个业务场景</p>
<h2 id="1-业务背景"><a href="#1-业务背景" class="headerlink" title="1.业务背景"></a>1.业务背景</h2><p>有三个角色 ：角色 A、角色 B、角色O(管理员)</p>
<p>有3个业务场景：场景 I、场景 II、场景 III</p>
<p>其中，场景 I 只有角色 A 可以访问，场景 II 只有角色 O 可以访问，场景 III 所有角色均可访问，则我们可以按照如下方式构建目录</p>
<p>其中场景 III index.js中，根据角色判断加载哪个角色的目录</p>
<h2 id="2-解决方案"><a href="#2-解决方案" class="headerlink" title="2.解决方案"></a>2.解决方案</h2><img src="/2017/03/12/浅谈大型%20react%20项目前端构建/pages.png" alt="pages.png" title="">
<p>角色和场景是一对一关系的时候，可以建以角色为根目录，场景为子目录的目录</p>
<p>角色和场景是多对一的关系的时候，可以建以场景为根目录，角色为子目录的目录。</p>
<h2 id="3-业务组件"><a href="#3-业务组件" class="headerlink" title="3.业务组件"></a>3.业务组件</h2><p>当页面中有该页面独有的业务组件时，请勿将其放入公共 components 组件目录，这样路径太远会不方便查找。</p>
<p>建议将该页面建一个目录，对应的业务组件放在该页面下</p>
<img src="/2017/03/12/浅谈大型%20react%20项目前端构建/A.png" alt="A.png" title="">
<p>场景 I 的部分伪代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">//index.js</span></div><div class="line"><span class="keyword">import</span> A <span class="keyword">from</span> <span class="string">'./组件 A'</span></div><div class="line"></div><div class="line"><span class="comment">//组件 A</span></div><div class="line"><span class="keyword">import</span> A<span class="number">.1</span> <span class="keyword">from</span> <span class="string">'./子组件 A.1'</span></div></pre></td></tr></table></figure>
<h3 id="这里有个小技巧"><a href="#这里有个小技巧" class="headerlink" title="这里有个小技巧"></a>这里有个小技巧</h3><p>要充分利用目录下的 index.js文件，它作为目录的入口</p>
<p>比如当你遇到业务升级，增加新功能时，可以按上述方式将页面转成目录。</p>
<img src="/2017/03/12/浅谈大型%20react%20项目前端构建/B.png" alt="B.png" title="">
<p>这样做的好处是:</p>
<p>import 时可以不用加<code>./index.js</code>,不需要改import 的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">import B from &apos;./B&apos;</div></pre></td></tr></table></figure>
<h1 id="四、redux"><a href="#四、redux" class="headerlink" title="四、redux"></a>四、redux</h1><p>不要滥用 redux</p>
<p>项目中当需要全局使用到的变量等的时候，才需要用到 redux。</p>
<p>利用 redux 可以将这个变量注入到你需要注入的页面。</p>
<h1 id="五、代码技巧"><a href="#五、代码技巧" class="headerlink" title="五、代码技巧"></a>五、代码技巧</h1><p>巧用export default</p>
<p>如</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//a.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> xxx</div><div class="line"><span class="keyword">export</span> xxx2</div><div class="line"></div><div class="line"><span class="comment">//引用时</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> xxx,&#123;xxx2&#125; <span class="keyword">from</span> <span class="string">'a'</span></div></pre></td></tr></table></figure>
<h1 id="六、构建工具（webpack）"><a href="#六、构建工具（webpack）" class="headerlink" title="六、构建工具（webpack）"></a>六、构建工具（webpack）</h1><p>使用 webpack 配置时，有些小技巧可以分享</p>
<h2 id="1-alias"><a href="#1-alias" class="headerlink" title="1.alias"></a>1.<code>alias</code></h2><p>开发时，引用其他目录的文件时，经常出现以下代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index.js</span></div><div class="line"><span class="keyword">import</span> A <span class="keyword">from</span> <span class="string">'../../../a'</span></div></pre></td></tr></table></figure>
<p>当你的目录结构变动时，修改相对路径对你来说，无疑就是一场灾难</p>
<p>其实你可以这么干，指定绝对路径</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">alias: &#123;</div><div class="line">  <span class="attr">_</span>: path.resolve(__dirname, <span class="string">'src'</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后你就可以</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index.js</span></div><div class="line"><span class="keyword">import</span> A <span class="keyword">from</span> <span class="string">'_/a'</span></div></pre></td></tr></table></figure>
<p>当 index.js 在目录中的位置变化时，你就可以不需要修改 index.js的任何代码了</p>
<h2 id="2-external"><a href="#2-external" class="headerlink" title="2.external"></a>2.<code>external</code></h2><p>为了避免react等基础库重复构建，可以利用 webpack的<code>externals</code>参数，避免重复构建。</p>
<p>这样，您需要构建的代码就只有 src 目录下的文件，且文件体积很小。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">externals: &#123; <span class="string">'react'</span>: <span class="string">'React'</span>, <span class="string">'react-dom'</span>: <span class="string">'ReactDOM'</span>, <span class="string">'react-router'</span>: <span class="string">'ReactRouter'</span> &#125;</div></pre></td></tr></table></figure>
<p>但这种方式目前来说有缺陷</p>
<ol>
<li>您必须手动将这些大文件基础库，事先 download 至本地。</li>
<li>node_modules 目录下的 react 库并没什么作用<br>后续可以考虑自动化的方式实现。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://tanyafuzhou.com/2017/03/12/浅谈大型 react 项目前端构建/" data-id="cj07feqic0000ivd85hu8dluh" class="article-share-link">Share</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react/">react</a></li></ul>

    </footer>
  </div>
  
</article>


    
  
  
</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 tanyafuzhou<br>
      Theme <a href="https://github.com/henryhuang/oishi" target="_blank">Oishi</a>, Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <!--
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/categories/react" class="mobile-nav-link">react</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    -->
    

<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>



<script src="/js/jquery.scrollUp.min.js"></script>
<script src="/js/jquery.transform.js"></script>
<script src="/js/menu.js"></script>

<script src="/js/script.js"></script>
<script src="/js/scrollUp.js"></script>

  </div>
</body>
</html>